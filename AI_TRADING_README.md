# 클로드 API와 업비트 API를 활용한 비트코인 자동매매 프로그램 사용 설명서

## 소개

이 프로그램은 클로드 API와 업비트 API를 통합하여 비트코인 자동매매를 수행합니다. 클로드 AI를 활용한 시장 분석과 기술적 지표 분석을 결합하여 매매 결정을 내리며, 신뢰도에 상관없이 AI의 결정에 따라 매매를 수행합니다.

## 설치 및 설정

### 1. API 키 설정

프로그램을 사용하기 위해 다음 API 키를 설정해야 합니다:

- 업비트 API 키: 계정 자산 확인 및 매매 주문에 사용
- 클로드 API 키: AI 기반 시장 분석에 사용

`.env` 파일을 루트 디렉토리에 생성하고 다음과 같이 설정합니다:

```
UPBIT_ACCESS_KEY=여기에_업비트_액세스키_입력
UPBIT_SECRET_KEY=여기에_업비트_시크릿키_입력
CLAUDE_API_KEY=여기에_클로드_API키_입력
ENABLE_TRADE=true
```

### 2. 필요 패키지 설치

`requirements.txt` 파일에 명시된 필요 패키지를 설치합니다:

```bash
pip install -r requirements.txt
```

## 매매 전략 설정

`config/trading_config.py` 파일에서 매매 전략을 조정할 수 있습니다:

### 주요 설정:

1. **결정 임계값 (Decision Thresholds)**
   - 매수/매도 결정을 위한 신호 강도 임계값이 낮게 설정되어 있어 AI의 판단에 따라 매매가 쉽게 이루어집니다.
   ```python
   DECISION_THRESHOLDS = {
       "buy_threshold": 0.05,    # 평균 신호가 이 값보다 크면 매수
       "sell_threshold": -0.05,  # 평균 신호가 이 값보다 작으면 매도
   }
   ```

2. **투자 비율 (Investment Ratios)**
   - 각 거래당 투자할 자산 비율을 설정합니다.
   ```python
   INVESTMENT_RATIOS = {
       "min_ratio": 0.2,  # 최소 투자 비율 (보유 자산의 20%)
       "max_ratio": 0.7,  # 최대 투자 비율 (보유 자산의 70%)
   }
   ```

3. **매매 간격 (Trading Interval)**
   - 매매 분석 및 결정을 내릴 시간 간격을 설정합니다.
   ```python
   TRADING_SETTINGS = {
       "trading_interval": 10,  # 10분마다 분석 및 매매 결정
       # 기타 설정...
   }
   ```

4. **클로드 AI 설정 (Claude AI Settings)**
   - AI 분석 결과의 가중치와 사용 방식을 설정합니다.
   ```python
   CLAUDE_SETTINGS = {
       "use_claude": True,        # Claude AI 분석 사용 여부
       "weight": 500,             # Claude AI 결과 가중치 (높게 설정)
       "ai_primary_decision": True, # AI가 주도적으로 결정
       # 기타 설정...
   }
   ```

## 프로그램 실행

### 1. 일반 모드 실행

일반 모드에서는 설정된 간격(기본 10분)마다 시장 분석과 매매를 수행합니다:

```
run_bot.bat
```

### 2. 이중 간격 모드 실행

이중 간격 모드에서는 기본 분석은 자주(1분), AI 분석은 덜 자주(30분) 수행합니다:

```
run_dual_trading.bat
```

## 주요 특징

1. **신뢰도 제한 없음**
   - 기존 코드에서는 신뢰도 70% 이상일 때만 거래했지만, 현재 버전은 신뢰도에 상관없이 Claude AI의 결정에 따라 매매를 실행합니다.

2. **AI 주도 결정**
   - 기술적 지표보다 Claude AI의 분석 결과를 우선시하도록 설정되어 있습니다.

3. **자동 매매 활성화**
   - `.env` 파일에서 `ENABLE_TRADE=true`로 설정하여 실제 매매가 이루어집니다.

4. **상세한 로깅**
   - 분석 결과와 거래 내역이 `logs` 디렉토리에 저장됩니다.

## 로그 확인

프로그램 실행 중 발생하는 로그는 다음 위치에 저장됩니다:

- 일반 로그: `logs/app.log`
- 매매 로그: `logs/trade.log`
- 오류 로그: `logs/error.log`
- 일별 분석 결과: `logs/trading_log_YYYYMMDD.json`
- 일별 거래 기록: `logs/trade_history_YYYYMMDD.json`

## 주의사항

1. 이 프로그램은 실제 자산을 이용한 거래를 수행하므로 주의해서 사용해야 합니다.
2. 처음 사용할 때는 소액으로 테스트하는 것을 권장합니다.
3. 프로그램의 매매 결정은 참고용이며, 최종 투자 결정은 사용자의 책임입니다.
4. 암호화폐 시장은 변동성이 매우 크므로 손실이 발생할 수 있습니다.
5. 시스템 오류나 네트워크 문제로 인해 예상치 못한 결과가 발생할 수 있습니다.

## 문제 해결

- `.env` 파일이 올바르게 설정되었는지 확인하세요.
- 업비트 API 키에 주문 권한이 있는지 확인하세요.
- 인터넷 연결이 안정적인지 확인하세요.
- 오류가 지속되면 로그 파일을 확인하여 세부 정보를 파악하세요.

## 개선 및 확장

- 다양한 코인에 대한 매매 지원
- 백테스팅 기능 추가
- 더 다양한 매매 전략 구현
- 모바일 알림 기능 추가

이 프로그램은 지속적으로 개선되고 있으며, 피드백과 기여를 환영합니다.